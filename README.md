# Driver Bot

Telegram бот для отслеживания местоположения водителя и отправки уведомлений о прибытии на работу.

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd driver-bot
```

2. Создайте виртуальное окружение и активируйте его:
```bash
python -m venv venv
source venv/bin/activate  # для Linux/Mac
venv\Scripts\activate     # для Windows
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Настройка

1. Создайте файл `.env` в корневой директории проекта и добавьте следующие переменные:
```
# Telegram Bot Token
TELEGRAM_TOKEN=your_telegram_bot_token

# Координаты работы
WORK_LATITUDE=55.676803
WORK_LONGITUDE=37.52351
WORK_RADIUS=100

# API URL
API_URL=http://194.87.236.174

# ID чатов
DRIVER_CHAT_ID=your_driver_chat_id
NOTIFICATION_CHAT_ID=your_notification_chat_id

# Настройки логирования
LOG_FILE=driver-bot.log
LOG_LEVEL=INFO

# Интервал проверки местоположения (в секундах)
CHECK_INTERVAL=60
```

2. Замените значения переменных на свои:
   - `TELEGRAM_TOKEN` - токен вашего Telegram бота (получите у @BotFather)
   - `DRIVER_CHAT_ID` - ID чата водителя
   - `NOTIFICATION_CHAT_ID` - ID чата для уведомлений
   - `WORK_LATITUDE` и `WORK_LONGITUDE` - координаты места работы
   - `WORK_RADIUS` - радиус в метрах, в пределах которого считается, что водитель на работе
   - `API_URL` - URL API для получения местоположения
   - `LOG_FILE` - путь к файлу логов
   - `LOG_LEVEL` - уровень логирования (INFO, DEBUG, WARNING, ERROR)
   - `CHECK_INTERVAL` - интервал проверки местоположения в секундах

## Запуск

1. Активируйте виртуальное окружение (если еще не активировано):
```bash
source venv/bin/activate  # для Linux/Mac
venv\Scripts\activate     # для Windows
```

2. Запустите бота:
```bash
python bot.py
```

## Использование

1. Откройте бота в Telegram
2. Отправьте команду `/start`
3. Используйте кнопки для управления отслеживанием:
   - "Включить отслеживание" - начать отслеживание местоположения
   - "Выключить отслеживание" - остановить отслеживание
   - "Статус" - проверить текущий статус отслеживания

## Функциональность

- Отслеживание местоположения водителя
- Автоматическое определение прибытия на работу
- Отправка уведомлений о прибытии
- Сохранение истории местоположений в базе данных
- Управление статусом отслеживания через Telegram

## Структура проекта

- `bot.py` - основной файл бота
- `db.py` - функции для работы с базой данных
- `config.py` - конфигурация бота
- `requirements.txt` - зависимости проекта
- `README.md` - документация
- `driver.db` - база данных SQLite (создается автоматически)

## Безопасность

- Файл `.env` содержит конфиденциальные данные и не должен быть добавлен в систему контроля версий
- Все API запросы выполняются через HTTPS
- Токен бота хранится только в переменных окружения
- База данных использует SQLite с ограниченным доступом 