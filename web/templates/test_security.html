<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–¢–µ—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - CleverDriver</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–∏—Å—Ç–æ—Ç—ã –∫–æ–¥–∞ CleverDriver">
    <meta name="robots" content="noindex, nofollow">
</head>
<body>
    <h1>üîí –¢–µ—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ CleverDriver</h1>
    <p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–∞–π—Ç–∞ –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞.</p>
    
    <div id="security-status">
        <h2>–°—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:</h2>
        <ul>
            <li>‚úÖ –í—Ä–µ–º—è: <span id="time"></span></li>
            <li>‚úÖ User-Agent: <span id="useragent"></span></li>
            <li>‚úÖ IP: <span id="ip">{{ request.remote_addr }}</span></li>
            <li>‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ JSTAG: <span id="jstag-status">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è...</span></li>
            <li>‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤: <span id="scripts-status">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è...</span></li>
            <li>‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ HTML: <span id="html-status">–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è...</span></li>
        </ul>
    </div>

    <div id="security-report">
        <h2>–û—Ç—á–µ—Ç –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:</h2>
        <div id="report-content"></div>
    </div>

    <script>
        // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è
        document.getElementById('time').textContent = new Date().toLocaleString('ru-RU');
        document.getElementById('useragent').textContent = navigator.userAgent;

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –±—ã–ª –ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥
        let jstagFound = false;
        if (typeof JSTAG !== 'undefined') {
            jstagFound = true;
            document.getElementById('jstag-status').innerHTML = '<span style="color:red;">‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω JSTAG!</span>';
        } else {
            document.getElementById('jstag-status').innerHTML = '<span style="color:green;">‚úÖ JSTAG –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω</span>';
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–Ω–µ—à–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç—ã
        let suspiciousScripts = [];
        const scripts = document.getElementsByTagName('script');
        for (let script of scripts) {
            if (script.src && (script.src.includes('JSTAG') || script.src.includes('eval') || script.src.includes('malicious'))) {
                suspiciousScripts.push(script.src);
            }
        }
        
        if (suspiciousScripts.length > 0) {
            document.getElementById('scripts-status').innerHTML = '<span style="color:red;">‚ùå –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã: ' + suspiciousScripts.join(', ') + '</span>';
        } else {
            document.getElementById('scripts-status').innerHTML = '<span style="color:green;">‚úÖ –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã</span>';
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Å—å HTML –Ω–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ (–∏—Å–∫–ª—é—á–∞–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏)
        const htmlContent = document.documentElement.outerHTML;
        const suspiciousPatterns = ['JSTAG', 'eval(', 'document.write', 'javascript:', 'vbscript:'];
        let foundSuspicious = false;
        
        for (let pattern of suspiciousPatterns) {
            // –ò—Å–∫–ª—é—á–∞–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏
            if (htmlContent.includes(pattern) && !htmlContent.includes('suspiciousPatterns') && !htmlContent.includes('foundSuspicious')) {
                foundSuspicious = true;
                break;
            }
        }
        
        if (foundSuspicious) {
            document.getElementById('html-status').innerHTML = '<span style="color:red;">‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ –≤ HTML!</span>';
        } else {
            document.getElementById('html-status').innerHTML = '<span style="color:green;">‚úÖ –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ –≤ HTML –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω</span>';
        }

        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç—á–µ—Ç
        const reportContent = document.getElementById('report-content');
        const allChecksPassed = !jstagFound && suspiciousScripts.length === 0 && !foundSuspicious;
        
        if (allChecksPassed) {
            reportContent.innerHTML = `
                <div style="background-color: #d4edda; border: 1px solid #c3e6cb; padding: 15px; border-radius: 5px; margin: 10px 0;">
                    <h3 style="color: #155724; margin: 0;">‚úÖ –°–∞–π—Ç –±–µ–∑–æ–ø–∞—Å–µ–Ω</h3>
                    <p style="color: #155724; margin: 5px 0 0 0;">
                        –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ. –°–∞–π—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞.
                    </p>
                </div>
            `;
        } else {
            reportContent.innerHTML = `
                <div style="background-color: #f8d7da; border: 1px solid #f5c6cb; padding: 15px; border-radius: 5px; margin: 10px 0;">
                    <h3 style="color: #721c24; margin: 0;">‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h3>
                    <p style="color: #721c24; margin: 5px 0 0 0;">
                        –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
                    </p>
                </div>
            `;
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        fetch('/test_security')
            .then(response => {
                const headers = response.headers;
                const securityHeaders = {
                    'Content-Security-Policy': headers.get('Content-Security-Policy'),
                    'X-Content-Type-Options': headers.get('X-Content-Type-Options'),
                    'X-Frame-Options': headers.get('X-Frame-Options'),
                    'X-XSS-Protection': headers.get('X-XSS-Protection'),
                    'Strict-Transport-Security': headers.get('Strict-Transport-Security')
                };
                
                let headersReport = '<h3>–ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:</h3><ul>';
                for (let [header, value] of Object.entries(securityHeaders)) {
                    if (value) {
                        headersReport += `<li style="color:green;">‚úÖ ${header}: ${value}</li>`;
                    } else {
                        headersReport += `<li style="color:orange;">‚ö†Ô∏è ${header}: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</li>`;
                    }
                }
                headersReport += '</ul>';
                
                document.getElementById('report-content').innerHTML += headersReport;
            })
            .catch(error => {
                console.log('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:', error);
            });
    </script>
</body>
</html> 