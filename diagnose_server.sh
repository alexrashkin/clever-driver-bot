#!/bin/bash

echo "üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –°–ï–†–í–ï–†–ê"
echo "======================"

echo "1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã..."
ps aux | grep python | grep -v grep

echo ""
echo "2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞..."
curl -s http://localhost:5000/ || echo "‚ùå –í–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 5000"

echo ""
echo "3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞..."
if [ -f "logs/web.log" ]; then
    echo "üìù –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å—Ç—Ä–æ–∫ –ª–æ–≥–∞:"
    tail -20 logs/web.log
else
    echo "‚ùå –§–∞–π–ª –ª–æ–≥–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi

echo ""
echo "4. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ Flask..."
if [ -f "flask.log" ]; then
    echo "üìù –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å—Ç—Ä–æ–∫ Flask –ª–æ–≥–∞:"
    tail -20 flask.log
else
    echo "‚ùå –§–∞–π–ª Flask –ª–æ–≥–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi

echo ""
echo "5. –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ..."
if [ -d "venv" ]; then
    echo "‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ"
    source venv/bin/activate
    python -c "import flask; print('‚úÖ Flask —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω')" || echo "‚ùå Flask –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
else
    echo "‚ùå –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
fi

echo ""
echo "6. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∞–π–ª app.py..."
if [ -f "web/app.py" ]; then
    echo "‚úÖ app.py –Ω–∞–π–¥–µ–Ω"
    python -c "from web.app import app; print('‚úÖ app.py –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è')" || echo "‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ app.py"
else
    echo "‚ùå app.py –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi

echo ""
echo "7. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Ä—Ç—ã..."
netstat -tlnp | grep :5000 || echo "‚ùå –ü–æ—Ä—Ç 5000 –Ω–µ –∑–∞–Ω—è—Ç"

echo ""
echo "8. –ü—Ä–æ–±—É–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä..."
cd web
python -c "from app import app; print('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É')" || echo "‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è" 