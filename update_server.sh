#!/bin/bash

echo "๐ ะะฑะฝะพะฒะปะตะฝะธะต ัะตัะฒะตัะฐ..."

# ะะพะดะบะปััะฐะตะผัั ะบ ัะตัะฒะตัั ะธ ะพะฑะฝะพะฒะปัะตะผ ะบะพะด
ssh root@194.87.236.174 << 'EOF'
    echo "๐ ะะตัะตัะพะดะธะผ ะฒ ะดะธัะตะบัะพัะธั ะฟัะพะตะบัะฐ..."
    cd /opt/driver-bot
    
    echo "๐ฅ ะะฑะฝะพะฒะปัะตะผ ะบะพะด ั GitHub..."
    git pull origin main
    
    echo "๐ ะัะพะฒะตััะตะผ ะฟัะพัะตััั..."
    ps aux | grep -E "(python|flask)" | grep -v grep
    
    echo "๐ ะััะฐะฝะฐะฒะปะธะฒะฐะตะผ ััะฐััะต ะฟัะพัะตััั..."
    pkill -f "python.*run_web.py" || echo "ะะตะฑ-ัะตัะฒะตั ะฝะต ะทะฐะฟััะตะฝ"
    pkill -f "python.*run_bot" || echo "ะะพั ะฝะต ะทะฐะฟััะตะฝ"
    
    echo "๐ ะะฐะฟััะบะฐะตะผ ะฒะตะฑ-ัะตัะฒะตั..."
    nohup python run_web.py > web.log 2>&1 &
    
    echo "๐ค ะะฐะฟััะบะฐะตะผ ะฑะพัะฐ..."
    nohup python run_bot.py > bot.log 2>&1 &
    
    echo "โณ ะะดะตะผ ะทะฐะฟััะบะฐ..."
    sleep 3
    
    echo "๐ ะัะพะฒะตััะตะผ ะฟัะพัะตััั..."
    ps aux | grep -E "(python|flask)" | grep -v grep
    
    echo "๐ ะัะพะฒะตััะตะผ ะฒะตะฑ-ัะตัะฒะตั..."
    curl -s http://localhost:5000/ | head -5
    
    echo "โ ะะฑะฝะพะฒะปะตะฝะธะต ะทะฐะฒะตััะตะฝะพ!"
EOF

echo "๐ ะกะตัะฒะตั ะพะฑะฝะพะฒะปะตะฝ!" 